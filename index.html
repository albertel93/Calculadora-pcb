<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Calculadora de Inserción</title>
  <style>
    body{font-family:sans-serif;background:#0f1115;color:#eee;padding:20px;margin:0}
    .card{background:#161a22;padding:20px;border-radius:12px;margin-bottom:20px}
    h2{margin:0 0 10px 0}
    label{display:block;margin-top:10px}
    .row{display:grid;grid-template-columns:1fr;gap:8px;margin-top:10px}
    @media (min-width:900px){ .row{grid-template-columns:1fr 1fr} }
    .group{border:1px solid #2a2f3a;border-radius:10px;padding:10px}
    .group h3{margin:0 0 8px 0;font-size:14px;color:#bfc6d4}
    .inputs2{display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .inputs2 > div{display:flex;flex-direction:column}
    .inputs2 label{margin-top:0}
    input{width:100%;padding:10px;margin-top:4px;border-radius:8px;border:1px solid #333;background:#0b0f16;color:#fff}
    button{margin-top:12px;padding:10px 14px;border:0;border-radius:8px;cursor:pointer;font-weight:600}
    #calcBtn{background:#6ee7b7;color:#000}
    #resetBtn{background:#333;color:#eee;margin-left:8px}
    .kpi{margin:6px 0;padding:10px;border:1px solid #333;border-radius:8px;display:flex;justify-content:space-between}
  </style>
</head>
<body>
  <div class="card">
    <h2>Entradas</h2>

    <div class="row">
      <div>
        <label>Cantidad de placas (lote)
          <input id="qty" type="number" value="">
        </label>
      </div>
      <div class="group">
        <h3>Precios por componente</h3>
        <div class="inputs2">
          <div>
            <label>TOP (€)
              <input id="topEUR" type="text" value="0.06" oninput="syncPair('top','EUR');">
            </label>
          </div>
          <div>
            <label>TOP (ptas)
              <input id="topPTA" type="text" value="" oninput="syncPair('top','PTA');">
            </label>
          </div>

          <div>
            <label>BOTTOM (€)
              <input id="botEUR" type="text" value="0.13" oninput="syncPair('bot','EUR');">
            </label>
          </div>
          <div>
            <label>BOTTOM (ptas)
              <input id="botPTA" type="text" value="" oninput="syncPair('bot','PTA');">
            </label>
          </div>

          <div>
            <label>SMD (€)
              <input id="smdEUR" type="text" value="0.13" oninput="syncPair('smd','EUR');">
            </label>
          </div>
          <div>
            <label>SMD (ptas)
              <input id="smdPTA" type="text" value="" oninput="syncPair('smd','PTA');">
            </label>
          </div>
        </div>
        <div style="margin-top:6px;color:#b0b8c6;font-size:12px">
          Conversión: 1 € = 166,386 ptas. Puedes escribir en <b>€</b> o en <b>ptas</b>; el campo de al lado se actualiza solo.
        </div>
      </div>
    </div>

    <div class="row">
      <div>
        <label>Componentes TOP por placa
          <input id="topCount" type="number" value="">
        </label>
      </div>
      <div>
        <label>Componentes BOTTOM por placa
          <input id="botCount" type="number" value="">
        </label>
      </div>
    </div>

    <div class="row">
      <div>
        <label>Componentes SMD por placa
          <input id="smdCount" type="number" value="">
        </label>
      </div>
      <div>
        <label>&nbsp;</label>
        <div>
          <button id="calcBtn" type="button" onclick="calc()">Calcular</button>
          <button id="resetBtn" type="button" onclick="resetAll()">Reset</button>
        </div>
      </div>
    </div>
  </div>

  <div class="card">
    <h2>Resultados (solo en € · sin IVA)</h2>
    <div class="kpi"><span>Coste TOP por placa</span><span id="topPerBoard">—</span></div>
    <div class="kpi"><span>Coste BOTTOM por placa</span><span id="botPerBoard">—</span></div>
    <div class="kpi"><span>Coste SMD por placa</span><span id="smdPerBoard">—</span></div>
    <div class="kpi"><strong>Total por placa</strong><strong id="totalPerBoard">—</strong></div>
    <div class="kpi"><strong>Total del lote</strong><strong id="totalLot">—</strong></div>
  </div>

  <script>
    var EUR_TO_PTAS = 166.386;
    var syncing = false;

    function num(v){
      if (typeof v !== 'string') v = String(v == null ? '' : v);
      v = v.replace(',', '.').replace(/[^0-9.\-]/g, '');
      var n = parseFloat(v);
      return isFinite(n) ? n : 0;
    }
    function fmtEUR(v){ v = Math.round(v*10000)/10000; return "€ " + v.toFixed(4); }

    function syncPair(base, from){
      if (syncing) return;
      syncing = true;
      var eurInput = document.getElementById(base + "EUR");
      var ptaInput = document.getElementById(base + "PTA");

      if (from === "EUR"){
        var eur = num(eurInput.value);
        var pta = eur * EUR_TO_PTAS;
        ptaInput.value = eurInput.value === "" ? "" : (Math.round(pta*100)/100).toFixed(2);
      } else {
        var pta2 = num(ptaInput.value);
        var eur2 = pta2 / EUR_TO_PTAS;
        eurInput.value = ptaInput.value === "" ? "" : (Math.round(eur2*10000)/10000).toFixed(4);
      }
      syncing = false;
    }

    function calc(){
      syncPair('top','EUR'); syncPair('bot','EUR'); syncPair('smd','EUR');

      var qty = num(document.getElementById("qty").value);
      var topCount = num(document.getElementById("topCount").value);
      var botCount = num(document.getElementById("botCount").value);
      var smdCount = num(document.getElementById("smdCount").value);

      var topEUR = num(document.getElementById("topEUR").value);
      var botEUR = num(document.getElementById("botEUR").value);
      var smdEUR = num(document.getElementById("smdEUR").value);

      var top = topCount * topEUR;
      var bot = botCount * botEUR;
      var smd = smdCount * smdEUR;
      var total = top + bot + smd;
      var lot = total * qty;

      document.getElementById("topPerBoard").textContent   = fmtEUR(top);
      document.getElementById("botPerBoard").textContent   = fmtEUR(bot);
      document.getElementById("smdPerBoard").textContent   = fmtEUR(smd);
      document.getElementById("totalPerBoard").textContent = fmtEUR(total);
      document.getElementById("totalLot").textContent      = fmtEUR(lot);
    }

    function resetAll(){
      var fields = ["qty","topCount","botCount","smdCount","topEUR","topPTA","botEUR","botPTA","smdEUR","smdPTA"];
      fields.forEach(id => { var el = document.getElementById(id); if (el) el.value = ""; });
      var outs = ["topPerBoard","botPerBoard","smdPerBoard","totalPerBoard","totalLot"];
      outs.forEach(id => document.getElementById(id).textContent = "—");
    }

    function init(){
      syncPair('top','EUR'); syncPair('bot','EUR'); syncPair('smd','EUR');
      calc();
    }
    init();
  </script>
</body>
</html>
